(()=>{"use strict";var e={5:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PhishingRuleContains=void 0;i.PhishingRuleContains=class{type(){return"contains"}isApplicable(e,i){return!(!e||!e.value)&&(!(e.value.length<1)&&-1!==i.indexOf(e.value.toLowerCase()))}}},39:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.LANG_NL=void 0,i.LANG_NL=[{key:"yes",value:"ja"},{key:"unlikely",value:"onwaarschijnlijk"},{key:"url",value:"URL"},{key:"save",value:"Opslaan"},{key:"is-phishing",value:"Is phishing"},{key:"probability",value:"Waarschijnlijkheid"},{key:"threshold",value:"Drempelwaarde"},{key:"invalid-rules-missing-fields",value:"Ongeldige regels: include- of exclude-velden missen!"},{key:"rules-saved",value:"Regels opgeslagen!"},{key:"invalid-rules",value:"Ongeldige regels!"},{key:"whitelist-domain",value:"Voer de volgende code in om het huidige domein uit te sluiten"},{key:"domain-whitelisted",value:"Het domein is uitgesloten"},{key:"invalid-code-try-again",value:"Ongeldige code. Probeer opnieuw."},{key:"title-report",value:"Detectierapport"},{key:"possible-phishing-attempt",value:"Mogelijke phishingpoging"},{key:"possible-phishing-attempt-details",value:"Je probeerde een pagina te bezoeken waar mogelijk een phishingsite op actief is. Pas de URL aan en probeer het opnieuw."},{key:"phishing-settings-title",value:"Instellingen voor phishingdetectie"},{key:"whitelist-button",value:"Domein uitsluiten"}]},73:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PhishingRuleStartsWith=void 0;i.PhishingRuleStartsWith=class{type(){return"startswith"}isApplicable(e,i){if(i.startsWith("http")){return i.replace("http://","").replace("https://","").startsWith(e.value.toLowerCase())}return i.startsWith(e.value.toLowerCase())}}},84:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.VERIFIEREN_RULES=void 0,i.VERIFIEREN_RULES={threshold:.1,include:[{name:"verifieren_phishing_include_rule_1",description:"A phishing rule to detect verifieren phishing attempts",phishingRuleType:"contains",value:"-verifieren",weight:1},{name:"verifieren_phishing_include_rule_2",description:"A phishing rule to detect verifieren phishing attempts",phishingRuleType:"contains",value:"verifieren-",weight:1},{name:"verifieren_phishing_include_rule_3",description:"A phishing rule to detect verifieren phishing attempts",phishingRuleType:"contains",value:"verfieren",weight:3},{name:"verificatie_phishing_include_rule_1",description:"A phishing rule to detect verificatie phishing attempts",phishingRuleType:"contains",value:"-verificatie",weight:1},{name:"verificatie_phishing_include_rule_2",description:"A phishing rule to detect verificatie phishing attempts",phishingRuleType:"contains",value:"verificatie-",weight:1},{name:"verificatie_phishing_include_rule_3",description:"A phishing rule to detect verificatie phishing attempts",phishingRuleType:"contains",value:"verficatie",weight:3}],exclude:[]}},97:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NL_KEYWORDS_RULES=void 0,i.NL_KEYWORDS_RULES={threshold:1,include:[{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"regex",value:"\\bhttps?://[^\\s/$.?#].[^\\s]*\\.(help|info|cc|xyz|tk|icu)([^\\s]*)?\\b",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"opwaardeer",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"veilig",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"waarschuwing",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"opwaarderen",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"deurwaarder",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"verifieren",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"verifieer",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"verificatie",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"geverifieerd",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"betalen",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"betaal",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"betaling",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"boete",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"sturen",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"stuur",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"factuur",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"rekening",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"nota",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"voorkom",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"update",weight:.3},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"bijwerken",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"bericht",weight:.3},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"dringend",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"spoedig",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"direct",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"actie",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"reactie",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"betaalgegevens",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"bevestig",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"teruggave",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"vordering",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"vernieuw",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"openstaand",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"herinnering",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"berichtenbox",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"pakket",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"vervang",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"blokkade",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"opnieuw",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"aangifte",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"toegang",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"belangrijk",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"urgent",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"alert",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"persoonlijk",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"betaalpas",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"beveiliging",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"noodzakelijk",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"actualiseer",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"actualiseren",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"bezorging",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"wijziging",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"identificatie",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"document",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"aanmaning",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"douanekosten",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"overtreding",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"factuur",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"ideal",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"ontvang",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"tikkie",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"winactie",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"bedrag",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"kenmerk",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"belasting",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"herstel",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"odido",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"kpn",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"ziggo",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"vodafone",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"simkaart",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"sim-kaart",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"contains",value:"sim-",weight:.5}],exclude:[{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"ing.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"abnamro.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"rabobank.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"bunq.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"volksbank.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"sns.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"triodos.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"vanlanschot.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"knab.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"bitvavo.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"rijksoverheid.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"belastingdienst.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"mijnoverheid.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"cjib.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"digid.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"politie.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"kvk.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"postnl.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"kpn.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"odido.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"vodafone.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"ziggo.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"essent.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"eneco.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"vattenfall.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"energiedirect.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"bol.com",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"facebook.com",weight:.3},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"instagram.com",weight:.3},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"anwb.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"coolblue.nl",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"tweakers.net",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"microsoft.com",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"google.com",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"revolut.com",weight:.5},{name:"nl_keyword",description:"A phishing rule to detect common scam keywords",phishingRuleType:"host",value:"sumup.com",weight:.5}]}},100:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ING_RULES=void 0,i.ING_RULES={threshold:1,include:[{name:"ing_phishing_include_rule_1",description:"A phishing rule to detect ING phishing attempts",phishingRuleType:"contains",value:"ing",weight:.5},{name:"ing_phishing_include_rule_2",description:"A phishing rule to detect ING phishing attempts",phishingRuleType:"contains",value:"іng",weight:1},{name:"ing_phishing_include_rule_3",description:"A phishing rule to detect ING phishing attempts",phishingRuleType:"contains",value:"íng",weight:1},{name:"ing_phishing_include_rule_4",description:"A phishing rule to detect ING phishing attempts",phishingRuleType:"contains",value:"ïng",weight:1}],exclude:[{name:"ing_phishing_exclude_rule_1",description:"A phishing rule to detect ING phishing attempts",phishingRuleType:"contains",value:"ing.nl/",weight:1},{name:"ing_phishing_exclude_rule_2",description:"A phishing rule to detect ING phishing attempts",phishingRuleType:"endswith",value:"ing.nl",weight:1}]}},101:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PhishingRuleRegex=void 0;i.PhishingRuleRegex=class{type(){return"regex"}isApplicable(e,i){if(!e||!e.value)return!1;return new RegExp(e.value).test(i)}}},180:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WETRANSFER_RULES=void 0,i.WETRANSFER_RULES={threshold:1,include:[{name:"wetransfer_rule",description:"Detect WeTransfer scams",weight:.5,phishingRuleType:"contains",value:"wetransfer"},{name:"wetransfer_rule",description:"Detect WeTransfer scams",weight:.5,phishingRuleType:"host",value:"onrender.com"},{name:"wetransfer_rule",description:"Detect WeTransfer scams",weight:.5,phishingRuleType:"host",value:"amazonaws.com"},{name:"wetransfer-rule",description:"A phishing rule to detect common scam keywords",phishingRuleType:"regex",value:"\\bhttps?://[^\\s/$.?#].[^\\s]*\\.(help|info|cc|xyz|tk|icu)([^\\s]*)?\\b",weight:.5}],exclude:[{name:"wetransfer_rule",description:"Detect WeTransfer scams",weight:1,phishingRuleType:"host",value:"wetransfer.com"}]}},271:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ICS_RULES=void 0,i.ICS_RULES={threshold:1,include:[{name:"ics_include_rule_with_homoglyphs_1",description:'A rule that matches on the value "ics-" with all possible homoglyphs',value:"[iIl1|][cC(<][sS5$][-–—]",weight:1,phishingRuleType:"regex"},{name:"ics_include_rule_with_homoglyphs_2",description:'A rule that matches on the value "-ics" with all possible homoglyphs',value:"[-–—][iIl1|][cC(<][sS5$]",weight:1,phishingRuleType:"regex"},{name:"ics_include_rule_with_homoglyphs_3",description:'A rule that matches on the value "icscard(s)" and "ics-card(s)" with all possible homoglyphs',value:"[i1l|]c[s5](-|)?[cçk]{1}[a4@]r[d|](s?)?",weight:1,phishingRuleType:"regex"}],exclude:[{name:"ics_exclude_rule_1",description:"All official ics sites",value:"^icscards\\.(nl|de|com)$",weight:-1,phishingRuleType:"regex"}]}},351:function(e,i,t){var n=this&&this.__awaiter||function(e,i,t,n){return new(t||(t=Promise))(function(s,o){function h(e){try{l(n.next(e))}catch(e){o(e)}}function r(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var i;e.done?s(e.value):(i=e.value,i instanceof t?i:new t(function(e){e(i)})).then(h,r)}l((n=n.apply(e,i||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0}),i.CommunityLoader=void 0;const s=t(905),o=t(553);i.CommunityLoader=class{constructor(){this._sources=[new s.Openfish,new o.PhishingDatabase],this._communityUrls=[]}getCommunityUrls(){return n(this,void 0,void 0,function*(){const e=this._sources.map(e=>e.fetch().then(e=>{e&&Array.isArray(e)&&e.length>0&&(this._communityUrls=[...this._communityUrls,...e])}).catch(e=>{throw Error(`Cannot fetch community data: ${e}`)}));return yield Promise.all(e).then(()=>[...new Set(this._communityUrls)])})}}},439:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.FirefoxStorage=void 0;i.FirefoxStorage=class{constructor(e){e&&this.initializeStorage(e)}getRules(e){browser.storage.local.get("settings").then(i=>{const t=i.settings.rules;e(t)})}updateRules(e){(e.length<1||e.every(e=>!e.include&&!e.exclude))&&(e=[]),browser.storage.local.get("settings").then(i=>{const t={settings:{rules:e,whitelistedUrls:i.settings.whitelistedUrls}};return browser.storage.local.set(t)})}getWhitelistedUrls(e){browser.storage.local.get("settings").then(i=>{const t=i.settings.whitelistedUrls;e(t)})}addWhitelistedUrl(e){const i=this.getBaseUrl(e);browser.storage.local.get("settings").then(e=>{const t=[...e.settings.whitelistedUrls,i],n=new Set(t),s={settings:{rules:e.settings.rules,whitelistedUrls:[...n]}};return browser.storage.local.set(s)})}updateTempUrl(e){const i=this.getBaseUrl(e);browser.storage.local.get("settings").then(e=>{const t={settings:{rules:e.settings.rules,whitelistedUrls:e.settings.whitelistedUrls,tempUrl:i}};return browser.storage.local.set(t)})}getTempUrl(e){browser.storage.local.get("settings").then(i=>{const t=i.settings.tempUrl||void 0;t&&e(t)})}getBaseUrl(e){const i=new URL(e);return`${i.protocol}//${i.host}`}initializeStorage(e){browser.storage.local.get("settings").then(i=>{this.isStorageObject(i)||this.initializeStorageObject(e)})}initializeStorageObject(e){const i={settings:{rules:e,whitelistedUrls:[]}};browser.storage.local.set(i)}isStorageObject(e){return e.rules&&e.threshold&&e.whitelistedUrls}}},454:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PhishingRuleEndsWith=void 0;i.PhishingRuleEndsWith=class{type(){return"endswith"}isApplicable(e,i){return i.endsWith(e.value.toLowerCase())}}},486:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.LANG_EN=void 0,i.LANG_EN=[{key:"yes",value:"yes"},{key:"unlikely",value:"unlikely"},{key:"url",value:"URL"},{key:"save",value:"Save"},{key:"is-phishing",value:"Is phishing"},{key:"probability",value:"Probability"},{key:"threshold",value:"Threshold"},{key:"invalid-rules-missing-fields",value:"Invalid rules: missing include or exclude fields!"},{key:"rules-saved",value:"Rules saved!"},{key:"invalid-rules",value:"Invalid rules!"},{key:"whitelist-domain",value:"Enter the following code to whitelist the current domain"},{key:"domain-whitelisted",value:"The domain is added to the whitelist"},{key:"invalid-code-try-again",value:"Invalid code. Try again."},{key:"title-report",value:"Detection Report"},{key:"possible-phishing-attempt",value:"Possible phishing attempt"},{key:"possible-phishing-attempt-details",value:"The request you made is a possible phishing attempt. Please check the URL and try again."},{key:"phishing-settings-title",value:"Phishing Detection Settings"},{key:"whitelist-button",value:"Whitelist current page"}]},504:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PhishingDetectionPlugin=void 0;const n=t(697),s=t(788),o=t(351);i.PhishingDetectionPlugin=class{constructor(e,i){this._storage=e,this._browserImpl=i,this._rules=[],this._communityUrls=[],this._whitelistedUrls=[],this.updateRules(),this.loadCommunityUrls(),this.setWhitelistedUrls(),this._browserImpl.webRequest.onBeforeRequest.addListener(e=>{if(this.updateRules(),this.updateBadgeScore(),this.setWhitelistedUrls(),"GET"===e.method){const i=e.url,t=this._whitelistedUrls.some(e=>i.startsWith(e));if(this.detectPhishing(i).some(e=>e.isPhishing)&&!t)return this.updateTempUrl(i),this.updateIcon("blocked.png"),this.updatePopup("unblock.html"),{redirectUrl:this._browserImpl.runtime.getURL("blocked.html")};this.updateIcon("shield.png"),this.updatePopup("report.html")}},{urls:["*://*/*"]},["blocking"])}setWhitelistedUrls(){this._storage.getWhitelistedUrls(e=>{this._whitelistedUrls=e})}updateBadgeScore(){this._browserImpl.tabs.query({active:!0,currentWindow:!0},e=>{if(e.length>0){const i=e[0].url;if(!i||i.startsWith("chrome-extension://"))return void this.updateBadge("");if(this._whitelistedUrls.some(e=>i.startsWith(e)))return void this.updateBadge("X");const t=(0,s.calculateBatchScore)(this._rules,i);this.updateBadge(t.phishingProbability)}})}detectPhishing(e){return new n.Engine(this._communityUrls,...this._rules).detect(e)}updateIcon(e){this._browserImpl.browserAction.setIcon({path:e})}updatePopup(e){this._browserImpl.browserAction.setPopup({popup:e})}updateBadge(e){this._browserImpl.browserAction.setBadgeText({text:e})}updateRules(){this._storage.getRules(e=>this._rules=e)}loadCommunityUrls(){(new o.CommunityLoader).getCommunityUrls().then(e=>this._communityUrls=e)}updateTempUrl(e){this._storage.updateTempUrl(e)}}},553:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PhishingDatabase=void 0;class t{constructor(){}static updateCache(e){t.CACHED_FEED=e}static getCache(){return t.CACHED_FEED}}t.CACHED_FEED=null;i.PhishingDatabase=class{constructor(){this._feed_url="https://raw.githubusercontent.com/Phishing-Database/Phishing.Database/refs/heads/master/phishing-links-NEW-today.txt"}fetch(){return null===t.getCache()?fetch(this._feed_url).then(e=>e.text()).then(e=>e.split("\n")).then(e=>(t.updateCache(e),e)):Promise.resolve(t.getCache())}}},557:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DEFAULT_RULES=void 0;const n=t(559),s=t(862);i.DEFAULT_RULES=[...s.ALL_INTERNATIONAL,...n.ALL_DUTCH]},559:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ALL_DUTCH=i.DUTCH_MISC=i.DUTCH_BANKS=void 0;const n=t(922),s=t(100),o=t(908),h=t(84),r=t(97);i.DUTCH_BANKS=[n.RABOBANK_RULES,s.ING_RULES],i.DUTCH_MISC=[r.NL_KEYWORDS_RULES,o.NU_RULES,h.VERIFIEREN_RULES],i.ALL_DUTCH=[...i.DUTCH_BANKS,...i.DUTCH_MISC]},682:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.I18n=void 0;const n=t(39),s=t(486);class o{constructor(){}static translate(e){const i=navigator.language.toLowerCase();let t=[];switch(!0){case i.includes("nl"):t=n.LANG_NL;break;case i.includes("en"):default:t=s.LANG_EN}const o=t.find(i=>i.key.toLowerCase()===e.toLowerCase());return o?o.value:e}}i.I18n=o,document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("i18n").forEach(e=>{e.childNodes.length>0&&e.childNodes.forEach(e=>{const i=e.textContent;console.log("key"),e.textContent=o.translate(i)})})})},697:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Engine=void 0;const n=t(717),s={isPhishing:!1,phishingProbability:0,threshold:0},o={isPhishing:!0,phishingProbability:1,threshold:0};i.Engine=class{constructor(e,...i){this._community_urls=e,this._rules_sets=[],this._rules_sets=i}detect(e){if(this._rules_sets.length<1)return[s];return this._community_urls.map(e=>e.toLowerCase()).includes(e.toLowerCase())?[o]:this._rules_sets.map(i=>{const t=this.runType(i,"contains",e),n=this.runType(i,"startswith",e),s=this.runType(i,"endswith",e),o=this.runType(i,"regex",e),h=this.runType(i,"host",e),r=this.calculateResult(i.threshold,[t,n,s,o,h]);return{isPhishing:r.isPhishing,phishingProbability:r.phishingProbability,threshold:i.threshold}})}runType(e,i,t){let s=0;const o=(new n.PhishingRuleFactory).getPhishingRuleImpl(i);return e.include&&e.include.filter(e=>e.phishingRuleType===i).filter(e=>o.isApplicable(e,t)).map(e=>e.weight).forEach(e=>s+=e),e.exclude&&e.exclude.filter(e=>e.phishingRuleType===i).filter(e=>o.isApplicable(e,t)).map(e=>e.weight).forEach(e=>s-=e),s}calculateResult(e,i){const t=i.filter(e=>0!==e);if(0===t.length)return s;const n=t.reduce((e,i)=>e+i,0);return{isPhishing:n>=e,phishingProbability:n}}}},717:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PhishingRuleFactory=void 0;const n=t(5),s=t(73),o=t(454),h=t(101),r=t(746);i.PhishingRuleFactory=class{getPhishingRuleImpl(e){switch(e){case"contains":return new n.PhishingRuleContains;case"startswith":return new s.PhishingRuleStartsWith;case"endswith":return new o.PhishingRuleEndsWith;case"regex":return new h.PhishingRuleRegex;case"host":return new r.PhishingRuleHost;default:throw new Error(`Phishing rule type ${e} is not supported`)}}}},746:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PhishingRuleHost=void 0;class t extends Error{constructor(e){super(e)}}i.PhishingRuleHost=class{type(){return"host"}isApplicable(e,i){if(!e||!e.value)return!1;if(e.value.length<1)return!1;let t=i;i.startsWith("http")||(t=`http://${i}`);return this.getHostName(t).toLowerCase()===e.value.toLowerCase()}getHostName(e){try{const i=new URL(e),t=i.hostname.split(".");return t.length>=2?t.slice(-2).join("."):i.hostname}catch(e){throw new t("Invalid URL:"+e)}}}},788:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.calculateBatchScore=void 0;const n=t(697),s=t(682);i.calculateBatchScore=(e,i)=>{const t=new n.Engine([],...e).detect(i).sort((e,i)=>e.phishingProbability>i.phishingProbability?1:-1).pop();return{isPhishing:t.isPhishing?s.I18n.translate("yes"):s.I18n.translate("unlikely"),phishingProbability:t.phishingProbability.toFixed(1),threshold:t.threshold.toFixed(1)}}},862:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ALL_INTERNATIONAL=void 0;const n=t(961),s=t(910);i.ALL_INTERNATIONAL=[...n.INT_BANK_RULES,...s.INT_COMPANIES]},868:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.MISC_BANK_RULES=void 0,i.MISC_BANK_RULES={threshold:.2,include:[{name:"int_bank_phishing_include_rule_1",description:"A phishing rule to detect bank phishing attempts",phishingRuleType:"contains",value:"bnk-",weight:.5},{name:"int_bank_phishing_include_rule_2",description:"A phishing rule to detect bank phishing attempts",phishingRuleType:"startswith",value:"bnk-",weight:.8}],exclude:[]}},905:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Openfish=void 0;class t{constructor(){}static updateCache(e){t.CACHED_FEED=e}static getCache(){return t.CACHED_FEED}}t.CACHED_FEED=null;i.Openfish=class{constructor(){this._feed_url="https://raw.githubusercontent.com/openphish/public_feed/refs/heads/main/feed.txt"}fetch(){return null===t.getCache()?fetch(this._feed_url).then(e=>e.text()).then(e=>e.split("\n")).then(e=>(t.updateCache(e),e)):Promise.resolve(t.getCache())}}},908:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NU_RULES=void 0,i.NU_RULES={threshold:.4,include:[{name:"nu_phishing_include_rule_1",description:"A phishing rule to detect nu.nl phishing attempts",phishingRuleType:"contains",value:"nu.nl",weight:.5}],exclude:[]}},910:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.INT_COMPANIES=void 0;const n=t(993),s=t(180);i.INT_COMPANIES=[n.BREWERIES_RULES,s.WETRANSFER_RULES]},922:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.RABOBANK_RULES=void 0,i.RABOBANK_RULES={threshold:1,include:[{name:"rabo_phishing_include_rule_1",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:"rabo",weight:.5},{name:"rabo_phishing_include_rule_2",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:"rbobank",weight:1},{name:"rabo_phishing_include_rule_3",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:"rabobnk",weight:1},{name:"rabo_phishing_include_rule_4",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:"rabbank",weight:1},{name:"rabo_phishing_include_rule_5",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:"rаbo",weight:1},{name:"rabo_phishing_include_rule_6",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:"bаnk",weight:.5},{name:"rabo_phishing_include_rule_7",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:"klantenservice",weight:.5},{name:"rabo_phishing_include_rule_8",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:"verificatie",weight:.5},{name:"rabo_phishing_include_rule_9",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:".com",weight:.5},{name:"rabo_phishing_include_rule_10",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:".cc",weight:.5},{name:"rabo_phishing_include_rule_11",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:".info",weight:.5},{name:"rabo_phishing_include_rule_12",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"contains",value:".xyz",weight:.5},{name:"rabo_phishing_include_rule_13",description:"A phishing rule to detect common scam keywords",phishingRuleType:"regex",value:"\\bhttps?://[^\\s/$.?#].[^\\s]*\\.(help|info|cc|xyz|tk|icu)([^\\s]*)?\\b",weight:.5}],exclude:[{name:"rabo_phishing_exclude_rule_1",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"startswith",value:"www.rabobank.nl",weight:2},{name:"rabo_phishing_exclude_rule_2",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"startswith",value:"rabobank.nl",weight:2},{name:"rabo_phishing_exclude_rule_3",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"startswith",value:"www.rabo-clubsupport.nl",weight:2},{name:"rabo_phishing_exclude_rule_4",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"startswith",value:"rabo-clubsupport.nl",weight:2},{name:"rabo_phishing_exclude_rule_5",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"endswith",value:"rabobank.nl",weight:2},{name:"rabo_phishing_exclude_rule_6",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"startswith",value:"media.rabobank.com",weight:2},{name:"rabo_phishing_exclude_rule_7",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"startswith",value:"rabobank.com",weight:2},{name:"rabo_phishing_exclude_rule_8",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"startswith",value:"www.rabobank.com",weight:2},{name:"rabo_phishing_exclude_rule_9",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"startswith",value:"apps.apple.com",weight:2},{name:"rabo_phishing_exclude_rule_10",description:"A phishing rule to detect rabobank phishing attempts",phishingRuleType:"startswith",value:"play.google.com",weight:2}]}},961:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.INT_BANK_RULES=void 0;const n=t(271),s=t(868);i.INT_BANK_RULES=[n.ICS_RULES,s.MISC_BANK_RULES]},993:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BREWERIES_RULES=void 0,i.BREWERIES_RULES={threshold:1,include:[{name:"brewery_gamification_rule_1",description:"Brewery gamification rule",weight:1,phishingRuleType:"regex",value:"^https?:\\/\\/([a-zA-Z0-9-]+\\.)?(www\\.)?wplnkr\\.(help|info|cc|xyz|tk|icu)(\\/.*)?$"}]}}},i={};function t(n){var s=i[n];if(void 0!==s)return s.exports;var o=i[n]={exports:{}};return e[n].call(o.exports,o,o.exports,t),o.exports}(()=>{const e=t(439),i=t(557),n=t(504),s=new e.FirefoxStorage(i.DEFAULT_RULES);new n.PhishingDetectionPlugin(s,browser)})()})();